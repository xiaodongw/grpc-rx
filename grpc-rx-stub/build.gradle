plugins {
  id "com.google.protobuf" version "0.8.3"
}

description = "gRPC: ReactiveX"

dependencies {
  compile "io.grpc:grpc-netty:${grpcJavaVersion}",
      "io.grpc:grpc-protobuf:${grpcJavaVersion}",
      "io.grpc:grpc-stub:${grpcJavaVersion}",
      "io.reactivex.rxjava2:rxjava:${rxJavaVersion}",
      'org.slf4j:slf4j-api:1.7.22'

  testCompile 'junit:junit:4.12',
      'org.slf4j:slf4j-simple:1.7.22'
}

protobuf {
  generatedFilesBaseDir = "$projectDir/gen"
  protoc {
    // The version of protoc must match protobuf-java. If you don't depend on
    // protobuf-java directly, you will be transitively depending on the
    // protobuf-java version that grpc depends on.
    artifact = "com.google.protobuf:protoc:${protobufVersion}"
  }
  plugins {
    grpc {
      //artifact = "io.grpc:protoc-gen-grpc-java:${grpcJavaVersion}"
      path = rxjavaPluginPath
    }
  }
  generateProtoTasks {
    all()*.plugins {
      grpc {}
    }
  }
}

sourceSets {
  test {
    java {
      srcDir "${protobuf.generatedFilesBaseDir}/test/java"
      srcDir "${protobuf.generatedFilesBaseDir}/test/grpc"
    }
  }
}
